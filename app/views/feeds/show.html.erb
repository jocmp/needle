<div class="mb-8">
  <!-- Profile header -->
  <div class="flex items-center gap-5 mb-6">
    <% if @feed.profile_picture_url.present? %>
      <img src="<%= @feed.profile_picture_url %>"
           alt=""
           class="w-20 h-20 rounded-full border-4 border-gold/50">
    <% else %>
      <div class="w-20 h-20 rounded-full border-4 border-gold/50
                  bg-sepia flex items-center justify-center">
        <span class="text-aged text-3xl font-serif">@</span>
      </div>
    <% end %>

    <div>
      <h1 class="font-display text-2xl text-burgundy-dark">
        <%= @feed.display_name %>
      </h1>
      <p class="text-aged">@<%= @feed.threads_handle.split('@').first %></p>
    </div>
  </div>

  <!-- Actions -->
  <div class="flex items-center gap-4 mb-6 text-sm">
    <%= link_to refresh_feed_path(@feed),
        method: :post,
        class: "text-gold hover:text-gold-dark uppercase tracking-wide",
        data: { turbo_method: :post } do %>
      <span class="mr-1">&#8635;</span> Refresh
    <% end %>
    <span class="text-aged/40">|</span>
    <%= button_to "Unsubscribe", @feed,
        method: :delete,
        class: "text-burgundy hover:text-burgundy-dark uppercase tracking-wide",
        data: { turbo_confirm: "Art thou certain? This cannot be undone." } %>
  </div>

  <!-- RSS URL box -->
  <div class="bg-sepia/30 border-2 border-gold/40 p-4 mb-8">
    <p class="text-sm text-aged uppercase tracking-wide mb-2">
      <span class="mr-1">&#9776;</span> Thy RSS Feed Address
    </p>
    <div class="flex items-center gap-2">
      <input type="text"
             readonly
             value="<%= feed_rss_url(@feed) %>"
             class="flex-1 bg-parchment px-3 py-2 border border-aged/30
                    text-sm font-mono text-aged"
             id="rss-url">
      <button onclick="navigator.clipboard.writeText(document.getElementById('rss-url').value)"
              class="bg-burgundy text-gold px-4 py-2 text-sm uppercase tracking-wide
                     hover:bg-burgundy-dark transition-colors">
        Copy
      </button>
    </div>
  </div>

  <!-- Divider -->
  <div class="flex justify-center mb-6">
    <div class="flex items-center gap-4 text-aged/50">
      <div class="w-16 h-px bg-aged/30"></div>
      <span class="text-lg">&#10048;</span>
      <div class="w-16 h-px bg-aged/30"></div>
    </div>
  </div>
</div>

<h2 class="font-display text-xl text-burgundy-dark text-center mb-6">
  Recent Dispatches
</h2>

<% if @entries.empty? %>
  <p class="text-aged italic text-center py-8">
    No dispatches have been received as yet.
  </p>
<% else %>
  <div class="space-y-6">
    <% @entries.each do |entry| %>
      <article class="border-l-4 border-gold/50 pl-5 py-2">
        <p class="text-ink leading-relaxed whitespace-pre-wrap">
          <%= entry.content %>
        </p>

        <% if entry.media_url.present? %>
          <% if entry.media_type == "image" %>
            <img src="<%= entry.media_url %>"
                 alt=""
                 class="mt-4 max-w-full h-auto border-2 border-aged/20">
          <% elsif entry.media_type == "video" %>
            <video src="<%= entry.media_url %>"
                   controls
                   class="mt-4 max-w-full border-2 border-aged/20">
            </video>
          <% end %>
        <% end %>

        <p class="text-aged/60 text-sm italic mt-3">
          <span class="mr-1">&#9998;</span>
          <%= entry.published_at&.strftime("%B %d, %Y at %l:%M %p") %>
        </p>
      </article>
    <% end %>
  </div>
<% end %>
